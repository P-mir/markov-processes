---
output: pdf_document
lang : fr-FR
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(comment = "")
```

```{r child='LSINF2275-Frontpage.RMD'}
```

\graphicspath{ {(C:/Users/Guillaume/Documents/GitHub/markov-processes/} }

\newpage

'\tableofcontents'

\newpage

```{r,include=F}
#---------CHARGEMENT DES SCRIPTS---------------------------------------------
setwd("~/GitHub/markov-processes")
source('transition_matrix.R')
source('value_iteration.R')
source('simulation_game.R')

library(knitr)
```


# 1. Introduction et explication du jeu (Guillaume)

L'objectif du projet est de mettre en application les processus de décision markovien sur un jeu de l'oie. Ce dernier est modélisé de la manière suivante : 


\begin{figure}[h]
\caption{Schéma du jeu de l'oie modifié}
\includegraphics{jeu de l'oie.PNG}
\centering
\end{figure}

Pour commencer, nous avons initialisé le jeu avec deux pièges. Le premier est situé sur la case 7 et le second sur la case 13. Le premier, en cas d'activation, fait reculer le joueur de 3 cases jusqu'à la case 4. Le second piège, quant à lui, ramène le joueur à la case 1. Il est important de préciser que le piège a une chance de s'activer dès que le joueur arrive sur la case piégée. Exemple : Le joueur démarre de la case 5 et réalise un 2 en jouant le dé normal, il arrivera donc sur la case 7. Le joueur a, dès lors, une chance sur deux de rester sur la case 7 ou de reculer de 3 cases. Cependant au prochain tour, le piège peut à nouveau s'activer si le joueur réalise un 0 (sauf s'il a joué le dé de sécurité).

Ensuite, le jeu sera joué selon deux règles différentes. La première règle stipule que le joueur gagne le jeu dès qu'il (dé)passe la case 15. La seconde règle qui est plus stricte exige à ce que le joueur arrive exactement sur la case 15 pour gagner le jeu. 

Pour la suite du projet, nous allons tout d'abord définir la stratégie optimale à jouer selon la règle en vigueur (règle 1 ou règle 2) grâce aux processus de decision markovien. Ensuite nous simulerons différentes parties afin de, tout d'abord, comparer les résultats théoriques et empiriques de la stratégie optimale mais également de comparer cette dernière avec d'autres stratégies qui seront normalement moins efficaces (jouer toujours le même dé ou jouer aléatoirement). 

# 2. Théorie : algorithme d'itération de la valeur (Patrick)

# 3. Simulation du jeu

Pour la simulation, afin d'obtenir des résultats précis, nous itérerons chaque partie 10 000 fois. Ces dernières seront jouées selon 5 stratégies différentes :

* La stratégie optimale définie dans la partie 2 selon la règle jouée
* Toujours le dé "sécurité" (dé 1) 
* Toujours le dé "normal" (dé 2) 
* Toujours le dé "risqué" (dé 3)
* Stratégie définie de manière aléatoire

## 3.1 Simulation selon la règle 1

Nous allons tout d'abord jouer selon la règle 1 qui est dîte souple. Ci-dessous, nous vous présentons les résultats des 10 000 parties jouées selon les différentes stratégies. Pour chaque partie, nous la débutons à partir de la case 1. 

\begin{figure}[h]
\caption{Boxplots - Règle 1 }
\includegraphics[height=10cm]{Boxplot_rule1.pdf}
\centering
\end{figure}

Nous pouvons déjà constater, qu'au départ de la case une, la stratégie optimale a de meilleurs résultats en moyenne par rapport aux 4 autres stratégies. La stratégie la moins efficace semble être celle qui joue toujours le dé de sécurité. De manière intuitive, ce résultat est cohérent car nous ne risquons pas de revenir aux premières cases lorsque nous dépassons la case 15. 

Ensuite, nous pouvons comparer les resultats des différentes stratégies au départ de n'importe quelle case du jeu. Le tableau, ci-dessous vous présente le nombre d'itérations moyen nécessaire pour terminer le jeu en fonction de la case où le jeu a débuté. 

```{r,include=T,echo=F}
result_matrix_rule1 <- read.table("result_matrix_rule1.txt")
colnames(result_matrix_rule1) <- c("Optimal policy","Dice 1","Dice 2", "Dice 3", "Random dice")
rownames(result_matrix_rule1)<- c("Square 1","Square 2","Square 3","Square 4","Square 5","Square 6","Square 7","Square 8","Square 9","Square 10","Square 11","Square 12","Square 13","Square 14")

kable(round(result_matrix_rule1,2),caption="Nombre d'itérations moyen en fonction de la case de départ")
```

Nous pouvons constater que la stratégie optimale est, en moyenne, soit meilleure ou équivalente aux autres stratégies de jeu quelque soit la case de départ. D'ailleurs, la stratégie de toujours jouer le dé risqué est assez similaire à la stratégie optimale. Ceci n'est pas étonnant car cette dernière préconise de jouer le dé risqué dans 12 cas sur 15. Cependant, si nous analysons l'écart-type des resultats des différentes stratégies, nous pouvons remarquer que la stratégie optimale fournit bien un résultat moins variable que la stratégie du dé risqué. 


```{r,include=T,echo=F}
variance_matrix_rule1<-read.table("variance_matrix_rule1.txt")
colnames(variance_matrix_rule1) <- c("Optimal policy","Dice 1","Dice 2", "Dice 3", "Random dice")
kable(round(variance_matrix_rule1,2),caption="Variance des différentes stratégies")
```


## 3.2 Simulation selon la règle 2

Nous allons maintenant changer la règle du jeu en obligeant le joueur de tomber exactement sur la case 15 afin de remporter la partie. Ci-dessous, retrouvez les résultats des differentes stratégies au départ de la case 1. 

\begin{figure}[h]
\caption{Boxplots - Règle 2 }
\includegraphics[height=10cm]{Boxplot_rule2.pdf}
\centering
\end{figure}

Selon la règle 2, jouer la stratégie optimale semble être plus efficace que les 4 autres stratégies. Contrairement au cas de la règle 1, ici c'est la stratégie du dé 1 qui semble se rapprocher de la stratégie optimale. Ceci est cohérent du au fait que nous revenons aux cases de départ si la case 15 est dépassée. 

Nous pouvons également analyser le résulat moyen au départ de n'importe quelle case du jeu : 

```{r,include=T,echo=F}
result_matrix_rule2 <- read.table("result_matrix_rule2.txt")
colnames(result_matrix_rule2) <- c("Optimal policy","Dice 1","Dice 2", "Dice 3", "Random dice")
rownames(result_matrix_rule2)<- c("Square 1","Square 2","Square 3","Square 4","Square 5","Square 6","Square 7","Square 8","Square 9","Square 10","Square 11","Square 12","Square 13","Square 14")

kable(round(result_matrix_rule2,2),caption="Nombre d'itérations moyen en fonction de la case de départ")
```

En analysant en détail, il apparaît clairement, que pour toutes les cases, la stratégie optimale est meilleure que n'importe quelle autre stratégie sauf pour la case 14 avec la stratégie du dé 1. En effet, la stratégie optimale préconise de jouer le dé sécurité pour l'avant dernière case du jeu.  

Nous pouvons également comparer l'indice de dispersion pour les resultats des différentes stratégies : 

```{r,include=T,echo=F}
variance_matrix_rule2<-read.table("variance_matrix_rule2.txt")
colnames(variance_matrix_rule2) <- c("Optimal policy","Dice 1","Dice 2", "Dice 3", "Random dice")
kable(round(variance_matrix_rule2,2),caption="Variance des différentes stratégies")
```

En plus de présenter le meilleur résultat moyen, la stratégie optimale est celle qui présente également une performance la moins variable dans le contexte de la règle 2. Ceci confirme qu'elle est belle est bien la plus éfficace. 


# 4. Adaptation du jeu

# 4.1 Ajout d'une prison (Patrick)

# 4.2 Adaptation de la pénalité d'une case (cost sensitive ?)

# 5. Conclusion

